<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · SPRFittingPaper2023.jl</title><meta name="title" content="API · SPRFittingPaper2023.jl"/><meta property="og:title" content="API · SPRFittingPaper2023.jl"/><meta property="twitter:title" content="API · SPRFittingPaper2023.jl"/><meta name="description" content="Documentation for SPRFittingPaper2023.jl."/><meta property="og:description" content="Documentation for SPRFittingPaper2023.jl."/><meta property="twitter:description" content="Documentation for SPRFittingPaper2023.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SPRFittingPaper2023.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../forward_simulation/">Forward Model</a></li><li><a class="tocitem" href="../surrogate_construction/">Surrogate Construction</a></li><li><a class="tocitem" href="../fitting/">Fitting Data</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Biophysical-and-Simulation-Parameters"><span>Biophysical and Simulation Parameters</span></a></li><li><a class="tocitem" href="#Forward-Simulations-and-Callbacks"><span>Forward Simulations and Callbacks</span></a></li><li><a class="tocitem" href="#Alignment-of-SPR-Data"><span>Alignment of SPR Data</span></a></li><li><a class="tocitem" href="#Surrogate"><span>Surrogate</span></a></li><li><a class="tocitem" href="#Fitting"><span>Fitting</span></a></li><li class="toplevel"><a class="tocitem" href="#Private-API-Functions"><span>Private API Functions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/isaacsas/SPRFittingPaper2023.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/main/docs/src/SPRFitting_api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="SPRFittingPaper2023.jl-API"><a class="docs-heading-anchor" href="#SPRFittingPaper2023.jl-API">SPRFittingPaper2023.jl API</a><a id="SPRFittingPaper2023.jl-API-1"></a><a class="docs-heading-anchor-permalink" href="#SPRFittingPaper2023.jl-API" title="Permalink"></a></h1><h2 id="Biophysical-and-Simulation-Parameters"><a class="docs-heading-anchor" href="#Biophysical-and-Simulation-Parameters">Biophysical and Simulation Parameters</a><a id="Biophysical-and-Simulation-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Biophysical-and-Simulation-Parameters" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.BioPhysParams" href="#SPRFittingPaper2023.BioPhysParams"><code>SPRFittingPaper2023.BioPhysParams</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct BioPhysParams{T&lt;:Number}</code></pre><p>Biophysical parameters to use in forward simulations.</p><p><strong>Fields</strong></p><ul><li><p><code>kon</code>: A –&gt; B rate, units of (μM s)⁻¹</p></li><li><p><code>koff</code>: B –&gt; A rate, units of s⁻¹</p></li><li><p><code>konb</code>: A+B –&gt; C rate, units of s⁻¹</p></li><li><p><code>reach</code>: Reach of A+B –&gt; C reaction, units of nm</p></li><li><p><code>CP</code>: CP factor (default = 1.0)</p></li><li><p><code>antigenconcen</code>: Concentration of antigen (default = <code>DEFAULT_SIM_ANTIGENCONCEN</code> μM)</p></li><li><p><code>antibodyconcen</code>: Concentration of antibodies, should be consistent with kon&#39;s units (default = 1.0 μM)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/parameters.jl#L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.biopars_from_fitting_vec" href="#SPRFittingPaper2023.biopars_from_fitting_vec"><code>SPRFittingPaper2023.biopars_from_fitting_vec</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">biopars_from_fitting_vec(p; antibodyconcen=1.0, antigenconcen=1.0)</code></pre><p>Generate a <a href="#SPRFittingPaper2023.BioPhysParams"><code>BioPhysParams</code></a> struct from a parameter vector from fitting.</p><p>Notes: </p><ul><li>Assumed that    <span>$p = [\log_{10}(\text{kon}), \log_{10}(\text{koff}), \log_{10}(\text{kon}_{\text{b}}), \text{reach}, \log_{10}(\text{CP})]$</span></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/parameters.jl#L32-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.SimParams" href="#SPRFittingPaper2023.SimParams"><code>SPRFittingPaper2023.SimParams</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct SimParams{T&lt;:Number, DIM}</code></pre><p>Biophysical parameters to use in forward simulations.</p><p><strong>Fields</strong></p><ul><li><p><code>N</code>: Number of particles (default <code>= 1000</code>)</p></li><li><p><code>tstop</code>: Time to end simulations at (default <code>= 600.0</code>)</p></li><li><p><code>tstop_AtoB</code>: Time to turn off A –&gt; B reaction, i.e. time the antibody bath is removed. (default <code>= Inf</code>)</p></li><li><p><code>tsave</code>: Times to save data at (default = <code>nothing</code>)</p></li><li><p><code>L</code>: Domain Length</p></li><li><p><code>initlocs</code>: Initial Particle Positions (default = uniform in <span>$[-L/2,L/2]^{\text{DIM}}$</span>)</p></li><li><p><code>resample_initlocs</code>: Resample <code>initlocs</code> every simulation (default <code>= true</code>)</p></li><li><p><code>nsims</code>: Number of simulations in runsim (to control sampling error) (default <code>= 1000</code>)</p></li></ul><p>Keyword Arguments:</p><ul><li>All fields have a corresponding kwarg.</li><li><code>antigenconcen = DEFAULT_SIM_ANTIGENCONCEN</code>, the default antigenconcen in units of (nm)⁻³ (unless using <code>convert_agc_units=false</code>).</li><li><code>DIM = 3</code> the dimension of the underlying space (i.e. 2 or 3). </li><li><code>convert_agc_units = true</code>, set to false to disable the conversion of the antigen units from assumed units of μM to (nm)⁻³, see below. In this case <span>$L$</span> is calculated using the antigen concentration value directly. </li><li><code>resample_initlocs = true</code>, if set to false <code>initlocs</code> will be constant, simply reusing the initial value sampled in the <code>SimParams</code> constructor.</li></ul><p>Notes:</p><ul><li>Uses the antigen concentration to determine <span>$L$</span>, and so needs to be updated if this concentration changes. The antigen concentration is first converted from assumed units of  μM to units of (nm)⁻³. Then <p class="math-container">\[  L = \left(\frac{N}{[\text{antigen}] \text{ in (nm)}^{-3}}\right)^{\tfrac{1}{DIM}}\]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/parameters.jl#L65">source</a></section></article><h2 id="Forward-Simulations-and-Callbacks"><a class="docs-heading-anchor" href="#Forward-Simulations-and-Callbacks">Forward Simulations and Callbacks</a><a id="Forward-Simulations-and-Callbacks-1"></a><a class="docs-heading-anchor-permalink" href="#Forward-Simulations-and-Callbacks" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.run_spr_sim!" href="#SPRFittingPaper2023.run_spr_sim!"><code>SPRFittingPaper2023.run_spr_sim!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_spr_sim!(outputter, biopars::BioPhysParams, simpars::SimParams,
             terminator = SimNumberTerminator())</code></pre><p>Runs a set of SPR simulations via the particle model for a fixed set of physical parameters.</p><p>Notes:</p><ul><li>Use the passed <a href="#SPRFittingPaper2023.BioPhysParams"><code>BioPhysParams</code></a> and <a href="#SPRFittingPaper2023.SimParams"><code>SimParams</code></a> to set simulation parameters (including number of simulations).</li><li>Use the <code>outputter</code> to specify a callback controlling what data is saved.</li><li>Use the <code>terminator</code> to specify a callback controlling when the simulation is stopped.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/forward_simulator.jl#L91-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.TotalBoundOutputter" href="#SPRFittingPaper2023.TotalBoundOutputter"><code>SPRFittingPaper2023.TotalBoundOutputter</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct TotalBoundOutputter{T}</code></pre><p>Callback that saves the amount of bound antibodies (i.e. monovalently + bivalently bound) at each save time.</p><p><strong>Fields</strong></p><ul><li><code>bindcnt</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/callbacks.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.TotalAOutputter" href="#SPRFittingPaper2023.TotalAOutputter"><code>SPRFittingPaper2023.TotalAOutputter</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct TotalAOutputter{T}</code></pre><p>Callback that saves the amount of unbound antigen at each save time.</p><p><strong>Fields</strong></p><ul><li><code>bindcnt</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/callbacks.jl#L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.means" href="#SPRFittingPaper2023.means"><code>SPRFittingPaper2023.means</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">means(o::TotalBoundOutputter)</code></pre><p>Vector of means.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/callbacks.jl#L49-L53">source</a></section><section><div><pre><code class="language-julia hljs">means(o::TotalAOutputter)</code></pre><p>Vector of means.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/callbacks.jl#L132-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.means!" href="#SPRFittingPaper2023.means!"><code>SPRFittingPaper2023.means!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">means!(m, o::TotalBoundOutputter)</code></pre><p>In-place vector of means.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/callbacks.jl#L56-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.vars" href="#SPRFittingPaper2023.vars"><code>SPRFittingPaper2023.vars</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vars(o::TotalBoundOutputter)</code></pre><p>Vector of variances.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/callbacks.jl#L68-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.sems" href="#SPRFittingPaper2023.sems"><code>SPRFittingPaper2023.sems</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">means(o::TotalBoundOutputter)</code></pre><p>Vector of standard errors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/callbacks.jl#L75-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.SimNumberTerminator" href="#SPRFittingPaper2023.SimNumberTerminator"><code>SPRFittingPaper2023.SimNumberTerminator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct SimNumberTerminator</code></pre><p>Callback that stops simulating when the desired number of simulations is reached.</p><p><strong>Fields</strong></p><ul><li><code>num_completed_sims</code>: How many simulations have been completed</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/callbacks.jl#L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.VarianceTerminator" href="#SPRFittingPaper2023.VarianceTerminator"><code>SPRFittingPaper2023.VarianceTerminator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct VarianceTerminator</code></pre><p>Callback that stops simulating when the variance in bound antibodies becomes sufficiently small or a maximum number of simulations is reached.</p><p><strong>Fields</strong></p><ul><li><p><code>ssetol</code>: The tolerance below which to stop simulating (default = .01).</p></li><li><p><code>notdone</code>: True if should keep iterating.</p></li><li><p><code>minsims</code>: Minimum number of sims to run (default = 15).</p></li><li><p><code>maxsims</code>: Maximum number of sims to run (default = 250).</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/callbacks.jl#L177">source</a></section></article><h2 id="Alignment-of-SPR-Data"><a class="docs-heading-anchor" href="#Alignment-of-SPR-Data">Alignment of SPR Data</a><a id="Alignment-of-SPR-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Alignment-of-SPR-Data" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.AlignedData" href="#SPRFittingPaper2023.AlignedData"><code>SPRFittingPaper2023.AlignedData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct AlignedData</code></pre><p>The aligned data from a set of SPR experiments varying antibody concentrations.</p><p><strong>Fields</strong></p><ul><li><p><code>times</code>: times[i] gives the SPR data timepoints for antibodyconcen[i]</p></li><li><p><code>refdata</code>: refdata[i] gives the SPR simulation data for antibodyconcens[i]</p></li><li><p><code>antibodyconcens</code>: Antibody concentrations for the SPR data set in μM</p></li><li><p><code>antigenconcen</code>: Antigen concentration for the SPR data set in μM</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/spr_data.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.get_aligned_data" href="#SPRFittingPaper2023.get_aligned_data"><code>SPRFittingPaper2023.get_aligned_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_aligned_data(fname, antigenconcen)</code></pre><p>Read the given CSV file representing aligned SPR data. Returns an <code>AlignedData</code> structure storing the given SPR experiment data.</p><p>Notes:</p><ul><li><code>antigenconcen = nothing</code> the concentration of antigen used in the experiments in units of μM. If not set assumes the CSV filename has the form &quot;&quot;text-AGCCONCEN_aligned.csv&quot;&quot;, and parses the number antigen concentration from AGCCONCEN.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/spr_data.jl#L20-L30">source</a></section></article><h2 id="Surrogate"><a class="docs-heading-anchor" href="#Surrogate">Surrogate</a><a id="Surrogate-1"></a><a class="docs-heading-anchor-permalink" href="#Surrogate" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.SurrogateParams" href="#SPRFittingPaper2023.SurrogateParams"><code>SPRFittingPaper2023.SurrogateParams</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SurrogateParams{T&lt;:Number}</code></pre><p>Biophysical parameters used in the surrogate.</p><p><strong>Fields</strong></p><ul><li><p><code>logkon_range</code>: log₁₀ space range of <code>kon</code>, first order rate in surrogate (units of s⁻¹).</p></li><li><p><code>logkoff_range</code>: log₁₀ space range of <code>koff</code> (units of s⁻¹).</p></li><li><p><code>logkonb_range</code>: log₁₀ space range of <code>konb</code>, Doi association rate in surrogate (units of s⁻¹).</p></li><li><p><code>reach_range</code>: linear range of reach values (units of nm)</p></li><li><p><code>antigenconcen</code>: Surrogate&#39;s internal antigen concentration in μM (default is <code>DEFAULT_SIM_ANTIGENCONCEN</code>).</p></li><li><p><code>antibodyconcen</code>: Surrogate&#39;s internal antibody concentration in μM (default is 1.0).</p></li><li><p><code>CP</code>: Surrogate&#39;s internal CP value (default is 1.0)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/surrogate.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.Surrogate" href="#SPRFittingPaper2023.Surrogate"><code>SPRFittingPaper2023.Surrogate</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct Surrogate{S, T, U, V, W}</code></pre><p>Surrogate parameters and data.</p><p><strong>Fields</strong></p><ul><li><p><code>surrogate_size</code>: Number of points for each coordinate within the surrogate lookup table.</p></li><li><p><code>itp</code>: Interpolation of the surrogate lookup table.</p></li><li><p><code>surpars</code>: <a href="#SPRFittingPaper2023.SurrogateParams"><code>SurrogateParams</code></a> used in the surrogate.</p></li><li><p><code>simpars</code>: Simulation parameters used in the surrogate.</p></li></ul><p>Arguments (one of the following two):</p><ul><li><code>lutfile =</code> the name of the file storing a surrogate to load.</li><li><code>lutdata =</code> <code>AbstractArray</code> representing the raw data points to build the surrogate from.</li></ul><p>Notes:</p><ul><li>All fields can also be passed as a keyword arg.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/surrogate.jl#L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.build_surrogate_serial" href="#SPRFittingPaper2023.build_surrogate_serial"><code>SPRFittingPaper2023.build_surrogate_serial</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_surrogate_serial(surrogate_size::Tuple, surpars::SurrogateParams, simpars::SimParams;
                       terminator=VarianceTerminator())</code></pre><p>Construct the data table array for a new surrogate by varying kon, koff, konb and reach.</p><p>Arguments:</p><ul><li><code>surrogate_size =</code> a Tuple with <code>(nkon,nkoff,nkonb,nreach)</code> points to use.</li><li><code>surpars =</code> the physical parameters to use in the surrogate. It is strongly recommended to not change the default values of <code>antigenconcen</code>, <code>antibodyconcen</code>, or <code>CP</code> unless you really know what you are doing –  these default values are implicitly assumed in other places.</li><li><code>simpars =</code> the simulation parameters to use (number of particles, simulations, domain size, etc).</li></ul><p>Keyword Arguments:</p><ul><li><code>terminator</code>, can be used to alter how the number of samples for each parameter set is determined. See <a href="#SPRFittingPaper2023.VarianceTerminator"><code>VarianceTerminator</code></a> for the default values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/surrogate.jl#L184-L202">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.save_surrogate" href="#SPRFittingPaper2023.save_surrogate"><code>SPRFittingPaper2023.save_surrogate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_surrogate(filename, surrogate_size, surpars::SurrogateParams, simpars::SimParams)</code></pre><p>Create a JLD file with the given surrogate metadata.</p><p>Arguments:</p><ul><li><code>surrogate_size =</code> a Tuple with <code>(nkon,nkoff,nkonb,nreach)</code> points to use.</li><li><code>surpars =</code> the physical parameters to use in the surrogate. It is strongly recommended to not change the default values of <code>antigenconcen</code>, <code>antibodyconcen</code>, or <code>CP</code> unless you really know what you are doing –  these default values are implicitly assumed in other places.</li><li><code>simpars =</code> the simulation parameters to use (number of particles, simulations, domain size, etc).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/surrogate.jl#L137-L150">source</a></section></article><h2 id="Fitting"><a class="docs-heading-anchor" href="#Fitting">Fitting</a><a id="Fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.fit_spr_data" href="#SPRFittingPaper2023.fit_spr_data"><code>SPRFittingPaper2023.fit_spr_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_spr_data(surrogate::Surrogate, aligneddat::AlignedData, searchrange;
             optimiser = nothing, u₀ = nothing)</code></pre><p>Find best fit parameters of the surrogate to the given data.</p><p>Notes:</p><ul><li><code>searchrange</code> should be a BlackBoxOptim compatible vector of <code>Tuple</code>s of the form:<pre><code class="nohighlight hljs">  searchrange = [logkon_optrange,logkoff_optrange,logkonb_optrange,reach_optrange,logCP_optrange]</code></pre>or<pre><code class="nohighlight hljs">  searchrange = [logCP_optrange]</code></pre>In the latter case the other parameter ranges are set equal to the range within the surrogate.</li><li>Uses <code>default_bivalent_optimiser</code> by default if <code>optimiser = nothing</code>. Otherwise pass an <code>Optimiser</code> object.</li><li><code>u₀</code> is an optional guess for the inital search point, methods may or may not use.</li><li>Returns the best fit optimization object and the best fit (bio) parameters as a tuple.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/fitting.jl#L116-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.optpars_to_physpars" href="#SPRFittingPaper2023.optpars_to_physpars"><code>SPRFittingPaper2023.optpars_to_physpars</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optpars_to_physpars(optpars, antibodyconcen, antigenconcen,
                            surrogate_antigenconcen)

optpars_to_physpars(optpars, aligned_data::AlignedData, surrogate::Surrogate)</code></pre><p>Converts parameters vector from BlackBoxOptim to physical parameters, converting the reach from simulation to physical values.</p><p>Notes:</p><ul><li>The reach is converted from the internal parameter value, εᵢ, to the physical value, εₑ, via<p class="math-container">\[  \varepsilon_e = \varepsilon_i \left(\frac{[AGC]_i}{[AGC]_e}\right)^{\tfrac{1}{3}},\]</p>where <span>$[AGC]_i$</span> is the internal simulator&#39;s antigen concentration and <span>$[AGC]_e$</span> is the concentration used in experiments.</li><li>Assumes these two concentrations have consistent units.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/fitting.jl#L179-L197">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.savefit" href="#SPRFittingPaper2023.savefit"><code>SPRFittingPaper2023.savefit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">savefit(optsol, aligneddat::AlignedData, surrogate::Surrogate, simpars::SimParams,
        outfile)</code></pre><p>Saves the data, simulated data with fit parameters, and fit parameters in an XLSX spreadsheet with the given name.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/fitting.jl#L313-L319">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.visualisefit" href="#SPRFittingPaper2023.visualisefit"><code>SPRFittingPaper2023.visualisefit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">visualisefit(optsol, aligneddat::AlignedData, simpars::SimParams,
             surrogate::Surrogate, filename=nothing)</code></pre><p>Plots fit between data and simulated curves using fitted parameters across a set of antibody concentrations.</p><p>Notes:</p><ul><li><code>filename = nothing</code> if set will cause the graph to be saved.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/fitting.jl#L243-L252">source</a></section></article><h1 id="Private-API-Functions"><a class="docs-heading-anchor" href="#Private-API-Functions">Private API Functions</a><a id="Private-API-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Private-API-Functions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.surrogate_sprdata_error" href="#SPRFittingPaper2023.surrogate_sprdata_error"><code>SPRFittingPaper2023.surrogate_sprdata_error</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">surrogate_sprdata_error(optpars, surrogate::Surrogate, aligned_data::AlignedData)</code></pre><p>This function takes a set of optimization parameters and interpolates a simulated kinetics curve from the surrogate, returning the <span>$L^2$</span> error against the provided data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/fitting.jl#L40-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SPRFittingPaper2023.update_pars_and_run_spr_sim!" href="#SPRFittingPaper2023.update_pars_and_run_spr_sim!"><code>SPRFittingPaper2023.update_pars_and_run_spr_sim!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_pars_and_run_spr_sim!(outputter, logpars, simpars::SimParams)</code></pre><p>Generate the biophysical parameters and run a forward simulation given parameters from the optimizer.</p><p>Arguments:</p><ul><li>outputter = an OutPutter instance for what simulation data to record</li><li>logpars   = vector of the five optimization parameters:             [logkon,logkoff,logkonb,reach,logCP]</li><li>simpars   = <a href="#SPRFittingPaper2023.SimParams"><code>SimParams</code></a> instance, should be consistent with the             surrogate</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/isaacsas/SPRFittingPaper2023.jl/blob/5173c5572a342d0a6815e8bb9c295ca6305c9cdb/src/fitting.jl#L214-L226">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../fitting/">« Fitting Data</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 10 September 2024 22:55">Tuesday 10 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
